import math
import pygame as pg



def init():
    """Initialization calls"""
    pg.init()
    screen = pg.display.set_mode((800, 600), flags=pg.RESIZABLE)
    return screen, pg.time.Clock()


def coords(x, y, screen):
    """Used to translate the coordinates origin to the center of the screen"""
    return screen.get_width() // 2 + x, screen.get_height() // 2 + y


def dft(signal):
    result = []
    N = len(signal)
    for k in range(N):
        re = 0
        im = 0
        for n in range(N):
            phi = (2 * math.pi * k * n) / N
            re += signal[n] * math.cos(phi)
            im -= signal[n] * math.sin(phi)
        re /= N
        im /= N
        amplitude = math.sqrt(re ** 2 + im ** 2)
        phase = math.atan2(im, re)

        result.append({
            'frequency': k,
            'amplitude': amplitude,
            'phase': phase
        })

    return sorted(result, key=lambda x: x['amplitude'], reverse=True)


import random

# Number of tuples to generate
num_tuples = 300

# Empty list to store tuples
random_tuples = []

# Generating random (x, y) tuples
for _ in range(num_tuples):
    x = random.uniform(0, 10)  # Replace 0 and 100 with your desired range for x
    y = random.uniform(0, 30)  # Replace 0 and 100 with your desired range for y
    random_tuples.append((x, y))

# Printing the generated tuples
pp = random_tuples

drawing = [
  (-75, -9),
  (-74, -10),
  (-73, -10),
  (-71, -10),
  (-70, -11),
  (-69, -11),
  (-68, -11),
  (-66, -11),
  (-65, -12),
  (-64, -12),
  (-63, -12),
  (-61, -13),
  (-60, -13),
  (-59, -13),
  (-58, -14),
  (-56, -14),
  (-55, -14),
  (-54, -15),
  (-53, -15),
  (-51, -15),
  (-50, -16),
  (-49, -16),
  (-48, -16),
  (-46, -16),
  (-45, -17),
  (-44, -17),
  (-43, -17),
  (-41, -18),
  (-40, -18),
  (-39, -18),
  (-38, -18),
  (-36, -19),
  (-35, -19),
  (-34, -19),
  (-33, -19),
  (-31, -19),
  (-30, -20),
  (-29, -20),
  (-27, -20),
  (-26, -20),
  (-25, -21),
  (-24, -21),
  (-22, -21),
  (-21, -21),
  (-20, -22),
  (-19, -22),
  (-17, -22),
  (-16, -22),
  (-15, -23),
  (-13, -23),
  (-12, -23),
  (-11, -23),
  (-10, -23),
  (-8, -24),
  (-7, -24),
  (-6, -24),
  (-5, -24),
  (-3, -25),
  (-2, -25),
  (-1, -25),
  (0, -25),
  (2, -25),
  (3, -26),
  (4, -26),
  (6, -26),
  (7, -26),
  (8, -26),
  (9, -27),
  (11, -27),
  (12, -27),
  (13, -27),
  (15, -27),
  (16, -27),
  (17, -28),
  (18, -28),
  (20, -28),
  (21, -28),
  (22, -28),
  (24, -28),
  (25, -29),
  (26, -29),
  (27, -29),
  (29, -29),
  (30, -29),
  (31, -29),
  (32, -29),
  (34, -30),
  (35, -30),
  (36, -30),
  (38, -30),
  (39, -30),
  (40, -30),
  (41, -30),
  (43, -31),
  (44, -31),
  (45, -31),
  (47, -31),
  (48, -31),
  (49, -31),
  (50, -31),
  (52, -32),
  (53, -32),
  (54, -32),
  (56, -32),
  (57, -32),
  (58, -32),
  (59, -32),
  (61, -32),
  (62, -32),
  (63, -32),
  (64, -33),
  (64, -34),
  (64, -35),
  (65, -37),
  (65, -38),
  (65, -39),
  (65, -41),
  (65, -42),
  (66, -43),
  (65, -44),
  (64, -43),
  (63, -43),
  (62, -42),
  (60, -42),
  (59, -42),
  (58, -41),
  (57, -41),
  (57, -42),
  (58, -43),
  (59, -44),
  (59, -45),
  (60, -46),
  (61, -47),
  (62, -48),
  (62, -49),
  (63, -50),
  (63, -51),
  (63, -53),
  (63, -54),
  (63, -55),
  (63, -56),
  (63, -58),
  (63, -59),
  (63, -60),
  (62, -60),
  (61, -60),
  (60, -59),
  (59, -59),
  (57, -58),
  (56, -58),
  (55, -58),
  (54, -57),
  (53, -57),
  (51, -56),
  (50, -56),
  (49, -55),
  (48, -55),
  (46, -54),
  (46, -54),
  (46, -53),
  (46, -51),
  (47, -50),
  (47, -49),
  (47, -48),
  (47, -46),
  (48, -45),
  (48, -44),
  (48, -42),
  (49, -41),
  (49, -40),
  (49, -39),
  (50, -37),
  (50, -36),
  (50, -35),
  (50, -34),
  (51, -32),
  (51, -32),
  (53, -32),
  (54, -32),
  (55, -32),
  (56, -32),
  (58, -32),
  (59, -32),
  (60, -32),
  (62, -32),
  (63, -32),
  (64, -32),
  (65, -32),
  (67, -32),
  (68, -32),
  (69, -32),
  (71, -32),
  (72, -32),
  (73, -32),
  (74, -32),
  (75, -32),
  (75, -30),
  (75, -29),
  (76, -28),
  (76, -26),
  (76, -25),
  (76, -24),
  (76, -23),
  (76, -21),
  (76, -20),
  (77, -19),
  (77, -17),
  (77, -16),
  (77, -15),
  (77, -14),
  (77, -12),
  (77, -11),
  (77, -10),
  (78, -8),
  (78, -7),
  (78, -6),
  (78, -5),
  (78, -3),
  (78, -2),
  (78, -1),
  (79, 1),
  (79, 2),
  (79, 3),
  (79, 4),
  (79, 6),
  (79, 7),
  (79, 8),
  (80, 10),
  (80, 11),
  (80, 12),
  (80, 13),
  (80, 15),
  (80, 16),
  (80, 17),
  (80, 19),
  (81, 20),
  (81, 21),
  (81, 22),
  (81, 24),
  (81, 25),
  (81, 26),
  (81, 28),
  (82, 29),
  (82, 30),
  (82, 31),
  (82, 33),
  (82, 34),
  (82, 35),
  (82, 37),
  (83, 38),
  (83, 39),
  (83, 40),
  (83, 42),
  (83, 43),
  (83, 44),
  (83, 45),
  (83, 47),
  (84, 48),
  (84, 49),
  (84, 51),
  (84, 52),
  (84, 53),
  (84, 54),
  (84, 56),
  (85, 57),
  (85, 58),
  (85, 60),
  (85, 61),
  (85, 62),
  (85, 63),
  (85, 65),
  (86, 66),
  (86, 67),
  (86, 69),
  (86, 70),
  (86, 71),
  (86, 72),
  (86, 74),
  (87, 75),
  (87, 76),
  (87, 78),
  (87, 79),
  (87, 80),
  (87, 81),
  (87, 83),
  (88, 84),
  (88, 85),
  (88, 87),
  (88, 88),
  (88, 89),
  (88, 90),
  (88, 92),
  (89, 93),
  (89, 94),
  (89, 96),
  (89, 97),
  (89, 98),
  (89, 99),
  (89, 101),
  (90, 102),
  (90, 103),
  (90, 105),
  (90, 106),
  (90, 107),
  (90, 108),
  (90, 110),
  (91, 111),
  (91, 112),
  (91, 113),
  (91, 115),
  (91, 116),
  (91, 117),
  (91, 119),
  (92, 120),
  (92, 121),
  (92, 122),
  (92, 124),
  (92, 125),
  (92, 126),
  (92, 128),
  (93, 129),
  (93, 130),
  (93, 131),
  (93, 130),
  (93, 128),
  (92, 127),
  (92, 126),
  (92, 125),
  (92, 123),
  (92, 122),
  (92, 121),
  (92, 119),
  (91, 118),
  (91, 117),
  (91, 116),
  (91, 114),
  (91, 113),
  (91, 112),
  (91, 110),
  (90, 109),
  (90, 108),
  (90, 107),
  (90, 105),
  (90, 104),
  (90, 103),
  (90, 101),
  (89, 100),
  (89, 99),
  (89, 98),
  (89, 96),
  (89, 95),
  (89, 94),
  (89, 92),
  (88, 91),
  (88, 90),
  (88, 89),
  (88, 87),
  (88, 86),
  (88, 85),
  (88, 83),
  (87, 82),
  (87, 81),
  (87, 80),
  (87, 78),
  (87, 77),
  (87, 76),
  (87, 74),
  (86, 73),
  (86, 72),
  (86, 71),
  (86, 69),
  (86, 68),
  (86, 67),
  (86, 65),
  (85, 64),
  (85, 63),
  (85, 62),
  (85, 61),
  (87, 61),
  (88, 61),
  (89, 61),
  (90, 61),
  (92, 61),
  (93, 61),
  (94, 61),
  (96, 61),
  (97, 61),
  (98, 61),
  (99, 61),
  (101, 61),
  (102, 61),
  (103, 61),
  (105, 61),
  (106, 61),
  (107, 61),
  (108, 61),
  (110, 61),
  (111, 61),
  (112, 61),
  (114, 61),
  (115, 61),
  (116, 61),
  (117, 61),
  (119, 62),
  (119, 61),
  (119, 59),
  (119, 58),
  (119, 57),
  (119, 55),
  (119, 54),
  (118, 53),
  (118, 52),
  (118, 50),
  (118, 49),
  (118, 48),
  (118, 46),
  (118, 45),
  (118, 44),
  (118, 43),
  (118, 41),
  (117, 40),
  (117, 39),
  (116, 38),
  (115, 38),
  (114, 38),
  (113, 38),
  (111, 39),
  (110, 39),
  (109, 39),
  (107, 39),
  (106, 39),
  (105, 39),
  (104, 39),
  (102, 39),
  (101, 39),
  (100, 39),
  (99, 39),
  (99, 41),
  (99, 42),
  (99, 43),
  (99, 45),
  (99, 46),
  (100, 47),
  (100, 48),
  (100, 50),
  (100, 51),
  (100, 52),
  (100, 54),
  (100, 55),
  (100, 56),
  (100, 58),
  (100, 59),
  (101, 60),
  (101, 61),
  (102, 61),
  (104, 61),
  (105, 61),
  (106, 61),
  (108, 61),
  (109, 61),
  (110, 61),
  (111, 61),
  (113, 61),
  (114, 61),
  (115, 61),
  (117, 61),
  (118, 61),
  (119, 62),
  (120, 62),
  (122, 62),
  (123, 62),
  (124, 62),
  (126, 62),
  (127, 62),
  (128, 62),
  (129, 62),
  (131, 62),
  (132, 62),
  (133, 62),
  (134, 61),
  (134, 60),
  (134, 59),
  (134, 57),
  (133, 56),
  (133, 55),
  (133, 54),
  (133, 52),
  (133, 51),
  (133, 50),
  (133, 48),
  (133, 47),
  (133, 46),
  (132, 45),
  (132, 43),
  (132, 42),
  (132, 41),
  (132, 39),
  (132, 38),
  (132, 37),
  (132, 36),
  (132, 34),
  (131, 33),
  (131, 32),
  (131, 30),
  (131, 29),
  (131, 28),
  (131, 27),
  (131, 25),
  (131, 24),
  (131, 23),
  (131, 21),
  (130, 20),
  (130, 19),
  (130, 18),
  (130, 16),
  (130, 15),
  (130, 14),
  (130, 12),
  (130, 11),
  (130, 10),
  (129, 9),
  (129, 7),
  (129, 6),
  (129, 5),
  (129, 3),
  (129, 2),
  (129, 1),
  (129, 0),
  (129, -2),
  (128, -3),
  (128, -4),
  (128, -6),
  (128, -7),
  (128, -8),
  (128, -9),
  (128, -11),
  (128, -12),
  (128, -13),
  (127, -15),
  (127, -16),
  (127, -17),
  (127, -18),
  (128, -19),
  (129, -18),
  (131, -18),
  (132, -18),
  (133, -18),
  (135, -18),
  (136, -18),
  (137, -18),
  (138, -17),
  (140, -17),
  (141, -17),
  (142, -17),
  (144, -17),
  (145, -17),
  (146, -17),
  (147, -16),
  (149, -16),
  (150, -16),
  (151, -16),
  (153, -16),
  (154, -16),
  (155, -15),
  (156, -15),
  (158, -15),
  (159, -15),
  (160, -15),
  (161, -15),
  (163, -15),
  (164, -14),
  (165, -14),
  (167, -14),
  (168, -14),
  (169, -14),
  (170, -14),
  (172, -14),
  (173, -13),
  (174, -13),
  (176, -13),
  (177, -13),
  (178, -13),
  (179, -13),
  (181, -12),
  (182, -12),
  (183, -12),
  (185, -12),
  (186, -12),
  (187, -12),
  (188, -12),
  (190, -11),
  (191, -11),
  (192, -11),
  (194, -11),
  (195, -11),
  (196, -11),
  (197, -11),
  (199, -10),
  (200, -10),
  (201, -10),
  (203, -10),
  (202, -10),
  (201, -10),
  (200, -10),
  (199, -10),
  (197, -11),
  (196, -11),
  (195, -11),
  (194, -11),
  (192, -11),
  (191, -11),
  (190, -11),
  (188, -12),
  (187, -12),
  (186, -12),
  (185, -12),
  (183, -12),
  (182, -12),
  (181, -12),
  (179, -13),
  (178, -13),
  (177, -13),
  (176, -13),
  (174, -13),
  (173, -13),
  (172, -14),
  (170, -14),
  (169, -14),
  (168, -14),
  (167, -14),
  (165, -14),
  (164, -14),
  (163, -15),
  (161, -15),
  (160, -15),
  (159, -15),
  (158, -15),
  (156, -15),
  (155, -15),
  (154, -16),
  (152, -16),
  (151, -16),
  (150, -16),
  (149, -16),
  (147, -16),
  (146, -17),
  (145, -17),
  (144, -17),
  (142, -17),
  (141, -17),
  (140, -17),
  (138, -17),
  (137, -18),
  (136, -18),
  (135, -18),
  (133, -18),
  (132, -18),
  (131, -18),
  (129, -18),
  (128, -19),
  (127, -19),
  (127, -20),
  (126, -22),
  (126, -23),
  (126, -24),
  (125, -25),
  (125, -26),
  (125, -28),
  (124, -29),
  (124, -30),
  (123, -31),
  (125, -31),
  (126, -31),
  (127, -31),
  (128, -31),
  (130, -31),
  (130, -32),
  (130, -33),
  (130, -34),
  (129, -36),
  (129, -37),
  (129, -38),
  (128, -39),
  (128, -41),
  (127, -42),
  (127, -43),
  (127, -44),
  (126, -45),
  (126, -47),
  (125, -48),
  (125, -49),
  (124, -50),
  (123, -51),
  (123, -52),
  (122, -54),
  (122, -55),
  (121, -56),
  (120, -57),
  (120, -58),
  (119, -59),
  (118, -60),
  (118, -61),
  (117, -62),
  (116, -64),
  (116, -65),
  (115, -66),
  (114, -67),
  (113, -68),
  (113, -69),
  (112, -70),
  (111, -71),
  (110, -72),
  (109, -73),
  (108, -74),
  (108, -75),
  (107, -76),
  (106, -77),
  (105, -78),
  (104, -78),
  (103, -79),
  (102, -80),
  (101, -81),
  (100, -82),
  (99, -83),
  (98, -83),
  (97, -84),
  (96, -85),
  (95, -86),
  (94, -86),
  (93, -87),
  (92, -88),
  (90, -88),
  (89, -89),
  (88, -90),
  (87, -90),
  (86, -91),
  (85, -91),
  (84, -92),
  (82, -92),
  (81, -93),
  (80, -94),
  (79, -94),
  (78, -94),
  (76, -95),
  (75, -95),
  (74, -96),
  (73, -96),
  (72, -96),
  (70, -97),
  (69, -97),
  (68, -98),
  (67, -98),
  (65, -98),
  (64, -98),
  (63, -99),
  (62, -99),
  (60, -99),
  (59, -99),
  (58, -100),
  (56, -100),
  (55, -100),
  (54, -100),
  (53, -100),
  (51, -101),
  (50, -101),
  (49, -101),
  (47, -101),
  (46, -101),
  (45, -101),
  (44, -101),
  (42, -101),
  (41, -101),
  (40, -101),
  (38, -101),
  (37, -101),
  (36, -101),
  (35, -101),
  (33, -101),
  (32, -101),
  (31, -101),
  (29, -101),
  (28, -101),
  (27, -101),
  (26, -101),
  (24, -101),
  (23, -100),
  (22, -100),
  (20, -100),
  (19, -100),
  (18, -100),
  (17, -100),
  (15, -99),
  (14, -99),
  (13, -99),
  (12, -99),
  (10, -98),
  (9, -98),
  (8, -98),
  (6, -98),
  (5, -97),
  (4, -97),
  (3, -97),
  (1, -97),
  (0, -96),
  (-1, -96),
  (-2, -96),
  (-4, -95),
  (-5, -95),
  (-6, -94),
  (-7, -94),
  (-9, -94),
  (-10, -93),
  (-11, -93),
  (-12, -92),
  (-13, -92),
  (-15, -91),
  (-16, -91),
  (-17, -90),
  (-18, -90),
  (-19, -89),
  (-20, -89),
  (-22, -88),
  (-23, -88),
  (-24, -87),
  (-25, -86),
  (-26, -86),
  (-27, -85),
  (-28, -85),
  (-30, -84),
  (-31, -83),
  (-32, -83),
  (-33, -82),
  (-34, -81),
  (-35, -81),
  (-36, -80),
  (-37, -79),
  (-39, -79),
  (-40, -78),
  (-41, -78),
  (-41, -79),
  (-41, -80),
  (-41, -82),
  (-42, -83),
  (-42, -84),
  (-43, -85),
  (-43, -86),
  (-44, -88),
  (-44, -89),
  (-45, -90),
  (-45, -91),
  (-46, -92),
  (-47, -93),
  (-48, -94),
  (-48, -95),
  (-49, -96),
  (-50, -97),
  (-51, -98),
  (-52, -99),
  (-53, -99),
  (-55, -100),
  (-56, -100),
  (-57, -101),
  (-58, -101),
  (-60, -101),
  (-61, -102),
  (-62, -102),
  (-63, -102),
  (-65, -102),
  (-66, -102),
  (-67, -102),
  (-69, -102),
  (-68, -103),
  (-68, -104),
  (-68, -106),
  (-69, -107),
  (-69, -108),
  (-69, -109),
  (-70, -111),
  (-70, -112),
  (-71, -113),
  (-72, -114),
  (-73, -115),
  (-74, -116),
  (-75, -116),
  (-76, -117),
  (-77, -118),
  (-78, -118),
  (-79, -119),
  (-81, -119),
  (-82, -119),
  (-83, -120),
  (-83, -121),
  (-84, -122),
  (-84, -123),
  (-84, -125),
  (-84, -126),
  (-85, -127),
  (-85, -128),
  (-86, -130),
  (-86, -131),
  (-87, -132),
  (-87, -133),
  (-88, -134),
  (-89, -135),
  (-89, -136),
  (-90, -137),
  (-91, -138),
  (-92, -139),
  (-93, -140),
  (-94, -141),
  (-95, -142),
  (-95, -143),
  (-96, -144),
  (-95, -144),
  (-94, -145),
  (-93, -146),
  (-92, -146),
  (-90, -147),
  (-89, -147),
  (-88, -148),
  (-87, -149),
  (-86, -149),
  (-85, -150),
  (-83, -150),
  (-82, -151),
  (-81, -151),
  (-80, -152),
  (-79, -153),
  (-78, -153),
  (-77, -154),
  (-75, -154),
  (-74, -155),
  (-73, -155),
  (-72, -156),
  (-71, -157),
  (-70, -157),
  (-68, -158),
  (-67, -158),
  (-66, -159),
  (-65, -159),
  (-64, -160),
  (-63, -160),
  (-61, -161),
  (-60, -161),
  (-59, -162),
  (-58, -162),
  (-57, -163),
  (-55, -163),
  (-54, -164),
  (-53, -164),
  (-52, -165),
  (-51, -165),
  (-50, -166),
  (-48, -166),
  (-47, -167),
  (-46, -167),
  (-45, -168),
  (-43, -168),
  (-42, -169),
  (-41, -169),
  (-40, -170),
  (-39, -170),
  (-37, -170),
  (-36, -171),
  (-35, -171),
  (-34, -171),
  (-32, -172),
  (-31, -172),
  (-30, -172),
  (-29, -173),
  (-27, -173),
  (-26, -173),
  (-25, -173),
  (-24, -174),
  (-22, -174),
  (-21, -174),
  (-20, -174),
  (-18, -175),
  (-17, -175),
  (-16, -175),
  (-15, -175),
  (-13, -176),
  (-12, -176),
  (-11, -176),
  (-10, -176),
  (-8, -176),
  (-7, -177),
  (-6, -177),
  (-4, -177),
  (-3, -177),
  (-2, -177),
  (-1, -177),
  (1, -178),
  (2, -178),
  (3, -178),
  (4, -178),
  (6, -178),
  (7, -178),
  (8, -179),
  (10, -179),
  (11, -179),
  (12, -179),
  (13, -179),
  (15, -179),
  (16, -179),
  (17, -179),
  (19, -180),
  (20, -180),
  (21, -180),
  (22, -180),
  (24, -180),
  (25, -180),
  (26, -180),
  (28, -180),
  (29, -180),
  (30, -180),
  (31, -180),
  (33, -180),

]

SignalX = [point[0] for point in drawing]
SignalY = [point[1] for point in drawing]

fourierX = dft(SignalX)
fourierY = dft(SignalY)

# scaling_factor = 1.2 # Adjust this factor to scale the epicycles


def epi_cycles(screen, x, y, rotation, fourier, time, color):
    for component in fourier:
        prev_x, prev_y = x, y
        freq = component['frequency']
        radius = component['amplitude'] 
        phase = component['phase']
        x += radius * math.cos(freq * time + phase + rotation)
        y += radius * math.sin(freq * time + phase + rotation)

        pg.draw.circle(screen, color, coords(prev_x, prev_y, screen), radius, 1)
        pg.draw.line(screen, (255, 255, 255), coords(prev_x, prev_y, screen), coords(x, y, screen))
    return x, y


def mainloop(screen: pg.Surface, main_clock: pg.time.Clock):
    background_color = "black"
    run = True

    time = 0
    path = []

    while run:
        for event in pg.event.get():
            if event.type == pg.QUIT:
                run = False

        screen.fill(background_color)

        v1x, v1y = epi_cycles(screen, 50, -200, 0, fourierX, time, (255,0,0))
        v2x, v2y = epi_cycles(screen, -300, 100, math.pi / 2, fourierY, time, (0,255,0))

        path.insert(0, (v1x, v2y))
        if len(path) > len(fourierX):
            path.pop()

        for i in range(1, len(path)):
            pg.draw.line(screen, (255, 255, 255), coords(path[i - 1][0], path[i - 1][1], screen), coords(path[i][0], path[i][1], screen))

        pg.draw.line(screen, (255, 255, 255), coords(v1x, v1y, screen), coords(v1x, v2y, screen))
        pg.draw.line(screen, (255, 255, 255), coords(v2x, v2y, screen), coords(v1x, v2y, screen))

        dt = (2 * math.pi) / len(fourierY)
        time += dt

        pg.display.flip()
        main_clock.tick(60)


def main():
    mainloop(*init())
    pg.quit()


if __name__ == "__main__":
    main()
